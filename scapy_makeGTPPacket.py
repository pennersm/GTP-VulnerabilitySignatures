from scapy.contrib import gtp_v2

Packets = PacketList()
seqn = random.randint(2000,10000)
udp_layer = UDP(sport=2123, dport=2123)
ip_layer = IP(src="20.1.1.1", dst="30.1.1.1")
ie_imsi = gtp_v2.IE_IMSI(length=8, IMSI="111111111111111") #len=12

for i in range (3, 255):
Packets.append(Ether(dst="b4:0c:25:e0:40:44", src="26:09:3c:d9:00:00") / ip_layer / udp_layer / gtp_v2.GTPHeader(gtp_type=i, length=20, P=0, teid=305419896, seq=seqn) / gtp_v2.GTPV2CreateSessionRequest(IE_list=[ie_imsi]))

wrpcap("GTPSessionStart.pcap",Packets) 
